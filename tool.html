
<!DOCTYPE html>
<html>
<head>
<title>Navigate your text</title>
<link rel="icon" href="src/favicon.png" type="image/png" />

<meta name="keywords" content="" />
<meta name="description" content = "" />
<meta name="viewport" content="width=device-width" />
<meta name="renderer" content="webkit" />
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />

<link href="css/bootstrap.min.css" rel="stylesheet" type="text/css" />

<script type="text/javascript" src="js/jquery.min.js"></script>
<script type="text/javascript" src="js/bootstrap.js"></script>

<style>
  p.highlight {
    font-weight: bold;
    color: red;
  }
</style>

<script type="text/javascript">
  
  $(document).ready( function() { 
    $(window).bind('keydown', function(e) {
      //window.alert(e.keyCode);
      if (e.keyCode == 83 /* s */) {
        readText(0);
        startTracking();
      }
      if (e.keyCode == 69 /* e */) {
        window.speechSynthesis.cancel();
      }
    });
  });

  var readText = function(index) {
    if (index < 0) {return;}

    var paras = $('#content-text').children('p');
    var cnt = $('#content-text').children('p').length;
    
    for (var i = index; i < cnt; i ++) {
      !function outer(ii){
        var curText = $(paras[ii]);
        var msg = new SpeechSynthesisUtterance();
        //var voices = window.speechSynthesis.getVoices();
        //msg.voice = voices[10]; // Note: some voices don't support altering params
        msg.voiceURI = 'native';
        msg.volume = 1; // 0 to 1
        msg.rate = 1.5; // 0.1 to 10
        msg.pitch = 2; //0 to 2
        msg.text = curText.text();
        msg.lang = 'en-US';
        
        msg.onstart = function(e) {
          //alert('start');
          curText.addClass('highlight');
        }
        
        msg.onend = function(e) {
          //alert('bye');
          curText.removeClass('highlight');
        };

        window.speechSynthesis.speak(msg);
      }(i)
    }

  }

  var startTracking = function() {
    var posX = -1, posY = -1;
    var markX = -1, markY = -1;
    var ii = 0;

    $('body').mousemove(function(e) {
      if (e.pageX > posX) { 
        $('#direction-x').text('+' + e.pageX);

        if (e.pageX - markX > 100) {
          if (markX != -1) {
            ii ++;

            // scroll the text
            window.speechSynthesis.cancel();
            readText(ii);
          }
          markX = e.pageX;
        }
      } else {
        $('#direction-x').text('-' + e.pageX);

        if (markX - e.pageX > 100) {
          if (markX != -1) {
            ii --;

            // scroll the text
            window.speechSynthesis.cancel();
            readText(ii);
          }
          markX = e.pageX;
        }
      }
      posX = e.pageX;


      // Nothing controlled by Y value
      if (e.pageY > posY) {
        $('#direction-y').text('+' + e.pageY);
      } else {
        $('#direction-y').text('-' + e.pageY);
      }
      posY = e.pageY;

    })
  }

</script>


</head>
<body>

<div id="coord">
  <span id="direction-x"></span> <span id="direction-y"></span>
</div>

<div id="content-text">
  <p>
    Hey Jude, don't make it bad<br>
    Take a sad song and make it better<br>
    Remember to let her into your heart<br>
    Then you can start to make it better<br>
  </p>
  <p>
    Hey Jude, don't be afraid<br>
    You were made to go out and get her<br>
    The minute you let her under your skin<br>
    Then you begin to make it better<br>
  </p>
  <p>
    And anytime you feel the pain, hey Jude, refrain<br>
    Don't carry the world upon your shoulders<br>
    For well you know that it's a fool who plays it cool<br>
    By making his world a little colder<br>
    Nah nah nah nah nah nah nah nah nah<br>
  </p>
  <p>
    Hey Jude, don't let me down<br>
    You have found her, now go and get her<br>
    Remember to let her into your heart<br>
    Then you can start to make it better<br>
  </p>
  <p>
    So let it out and let it in, hey Jude, begin<br>
    You're waiting for someone to perform with<br>
    And don't you know that it's just you, hey Jude, you'll do<br>
    The movement you need is on your shoulder<br>
    Nah nah nah nah nah nah nah nah nah yeah<br>
  </p>
  <p>
    Hey Jude, don't make it bad<br>
    Take a sad song and make it better<br>
    Remember to let her under your skin<br>
    Then you'll begin to make it<br>
    Better better better better better better, oh<br>
  </p>   
  <p>
    Nah nah nah nah nah nah, nah nah nah, hey Jude<br>
    Nah nah nah nah nah nah, nah nah nah, hey Jude<br>
    Nah nah nah nah nah nah, nah nah nah, hey Jude<br>
    Nah nah nah nah nah nah, nah nah nah, hey Jude<br>
    Nah nah nah nah nah nah, nah nah nah, hey Jude<br>
    Nah nah nah nah nah nah, nah nah nah, hey Jude<br>
    Nah nah nah nah nah nah, nah nah nah, hey Jude<br>
    Nah nah nah nah nah nah, nah nah nah, hey Jude<br>
    Nah nah nah nah nah nah, nah nah nah, hey Jude<br> 
    Nah nah nah nah nah nah, nah nah nah, hey Jude<br>
    Nah nah nah nah nah nah, nah nah nah, hey Jude<br>
    Nah nah nah nah nah nah, nah nah nah, hey Jude<br>
    Nah nah nah nah nah nah, nah nah nah, hey Jude<br>
    Nah nah nah nah nah nah, nah nah nah, hey Jude<br>
    Nah nah nah nah nah nah, nah nah nah, hey Jude<br>
    Nah nah nah nah nah nah, nah nah nah, hey Jude<br>
  </p>
  
</div>

</body>
</html>